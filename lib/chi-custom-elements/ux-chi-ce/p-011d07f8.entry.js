import{r as t,c as i,h as s,F as e,g as h}from"./p-99c091ba.js";import{c as n}from"./p-1ef4f618.js";import{C as a}from"./p-1ad0e10c.js";import{h as o}from"./p-c6d5045e.js";import{b as c}from"./p-834de5c7.js";import{v as r}from"./p-d1e6806c.js";const l=class{constructor(s){t(this,s),this.eventChange=i(this,"chiChange",7),this.eventInput=i(this,"chiInput",7),this.eventFocus=i(this,"chiFocus",7),this.eventBlur=i(this,"chiBlur",7),this.eventClean=i(this,"chiClean",7),this.eventSearch=i(this,"chiSearch",7),this.eventItemSelected=i(this,"chiSearchInputItemSelected",7),this.size="md",this.value="",this.disabled=!1,this.preventValueMutation=!1,this.readonly=!1,this._cleanButtonVisible=!(!this.value||this.disabled),this.menuItemsFiltered=[],this._handleSelectItem=(t,i)=>{t.preventDefault();const s=this._getAutocompleteDropdown(),e=t.target.innerText,{href:h,id:n}=null!=i?i:{};this.selectedItem=c({title:e,href:h,id:n}),this.value=e,s.hide(),this._clearFilterMenuItems(),this.eventItemSelected.emit(this.selectedItem)},this._clearInputField=()=>{this.readonly||this._cleanInput()}}sizeValidation(t){const i=n.join(", ");if(t&&!n.includes(t))throw new Error(`${t} is not a valid size for input. If provided, valid values are: ${i}. `)}updateValue(t,i){this._cleanButtonVisible=!!t,t!==i&&(this.value=t)}stateValidation(t){const i=a.join(", ");if(t&&!a.includes(t))throw new Error(`${t} is not a valid state for input. If provided, valid values are: ${i}. `)}async showList(){const t=this._getAutocompleteDropdown(),i=this.el.querySelector("input[type=search]");null==t||t.show(),null==i||i.focus()}async hideList(){const t=this._getAutocompleteDropdown();null==t||t.hide()}connectedCallback(){this.menuItemsFiltered=this.menuItems}componentWillLoad(){this.sizeValidation(this.size),this.stateValidation(this.state)}_handleValueInput(t){const i=t.target.value,s=this._isAutocomplete();i||this._resetSelection(),this.preventValueMutation||(this.value=i),this._cleanButtonVisible=!!i,this.eventInput.emit(i),s&&this._handleFilter(i)}_setHighlightedValue(t,i){return i?t.map((t=>{const s=new RegExp(i,"gi"),e=t.title.replace(s,(t=>`<span class="-text--normal">${t}</span>`));return Object.assign(Object.assign({},t),{title:`<strong>${e}</strong>`})})):t}_clearFilterMenuItems(){this._isAutocomplete()&&(this.menuItemsFiltered=this.menuItems)}_getAutocompleteDropdown(){return this.el.querySelector("#dropdown-autocomplete")}_handleFilter(t){var i;const s=this._getAutocompleteDropdown(),e=null===(i=this.menuItems)||void 0===i?void 0:i.filter((i=>i.title.toLowerCase().includes(t.toLowerCase())));if(!(null==e?void 0:e.length))return void s.hide();const h=this._setHighlightedValue(e,t);this.menuItemsFiltered=h,s.show()}_handleValueChange(t){this.eventChange.emit(t.target.value)}_handleFocus(t){this._isAutocomplete()&&this._handleFilter(t.target.value),this.eventFocus.emit()}_isAutocomplete(){return"autocomplete"===this.mode}_cleanInput(){const t=this.el.querySelector("input[type=search]");this.value="",t.value=this.value,this._clearFilterMenuItems(),t.focus(),this._cleanButtonVisible=!1,this.eventClean.emit(),this._resetSelection()}_resetSelection(){if(!this._isAutocomplete())return;const t=this._getAutocompleteDropdown();this.selectedItem=void 0,t.resetSelection()}_dropdownAutocomplete(t){var i,e;const h=null!==(i=this.visibleItems)&&void 0!==i?i:null;return s("chi-dropdown",{id:"dropdown-autocomplete",position:"bottom",preventItemSelected:!0,fluid:!0,visibleItems:h},t,null===(e=this.menuItemsFiltered)||void 0===e?void 0:e.map((t=>{const i=r();return s("a",{key:`menu-item-${i}`,class:o.MENU_ITEM,href:t.href,slot:"menu",innerHTML:t.title,onClick:i=>this._handleSelectItem(i,t)})})))}_getHelperMessage(){return this.helperMessage&&s("chi-helper-message",{state:this.state},this.helperMessage)}_addHelperMessage(t){return s(e,null,t,this._getHelperMessage())}render(){const t=this._isAutocomplete(),i=s("input",{key:"3d563e22ada6ec28dfa35ca1ee534f9278e57a92",type:"search",class:`\n          chi-input chi-search__input\n          ${this.size?`-${this.size}`:""}\n          ${this.state?`-${this.state}`:""}\n          ${this._status?`-${this._status}`:""}\n        `,placeholder:this.placeholder||"",value:this.value,name:this.name||"",disabled:this.disabled,id:this.el.id?`${this.el.id}-control`:null,onFocus:t=>this._handleFocus(t),onBlur:()=>this.eventBlur.emit(),onInput:t=>this._handleValueInput(t),onChange:t=>this._handleValueChange(t),autocomplete:"off","aria-label":"search input",readonly:this.readonly}),e=this._cleanButtonVisible?s("button",{class:"chi-button -icon -close -xs",onClick:this._clearInputField,onMouseDown:t=>t.preventDefault(),"aria-label":"Clear"},s("div",{class:"chi-button__content"},s("i",{class:"chi-icon icon-x","aria-hidden":"true"}))):null,h=s("button",{key:"ca32fd42c45c464cbe9e7b36e9767ee5409f8e29",class:`\n        chi-button -icon -flat -bg--none\n        ${this.size?`-${this.size}`:""}\n        `,onClick:()=>this.eventSearch.emit(this.value),"aria-label":"Search"},s("div",{key:"e764043830f209fff82d13642ac87ce03fc4341f",class:"chi-button__content"},s("i",{key:"39a46fb2ad8cdde82103405eff134901e1ed49af",class:"chi-icon icon-search","aria-hidden":"true"}))),n=s("div",{key:"97378aa4a655c7fc9469fc6f8ede6b1aede79c5c",class:"chi-input__wrapper -icon--right",slot:"trigger"},i,e,h);let a=t?this._dropdownAutocomplete(n):n;return this.helperMessage&&(a=this._addHelperMessage(a)),a}get el(){return h(this)}static get watchers(){return{size:["sizeValidation"],value:["updateValue"],state:["stateValidation"]}}};l.style="chi-search-input.sc-chi-search-input-h{display:block;width:100%}";export{l as chi_search_input}