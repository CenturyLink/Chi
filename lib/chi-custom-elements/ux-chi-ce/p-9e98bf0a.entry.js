import{r as t,c as i,h as s,g as e}from"./p-0c0cd099.js";import{L as h,U as o,K as n,O as r,Q as l,c,n as d,V as a,W as u,X as p}from"./p-ed8c4a28.js";import{a as v}from"./p-9cb46040.js";import{v as m}from"./p-699f21d6.js";import{P as g}from"./p-c8326a28.js";import{a as f}from"./p-eb9b9d80.js";import{a as b}from"./p-d5dd2498.js";import{D as w}from"./p-0019854f.js";import{C as $}from"./p-1ad0e10c.js";const C=class{constructor(s){t(this,s),this.chiChange=i(this,"chiChange",7),this.label=void 0,this.name=void 0,this.checked=void 0,this.indeterminate=void 0,this.disabled=void 0,this.required=!1,this.state=void 0,this._status=void 0,this.infoIcon=!1,this.infoIconMessage=""}connectedCallback(){var t;this.id=null!==(t=this.el.getAttribute("id"))&&void 0!==t?t:m(),v.call(this)}componentWillLoad(){this.helpButtonId=`help-button-${m()}`,this.helpPopoverId=`help-popover-${m()}`}componentDidLoad(){this._updateIndeterminate()}toggle(t){this.checked=t.target.checked,this.indeterminate=!1,this._emitChange(this.checked)}_emitChange(t){this.chiChange.emit(t)}_updateIndeterminate(){this.input.indeterminate=this.indeterminate}updateIndeterminate(t,i){t!==i&&this._updateIndeterminate()}toggleHelpPopover(){this.el.querySelector(`#${this.helpPopoverId}`).toggle()}_getInfoIcon(){return this.infoIcon?s("div",{class:`${h.HELP} ${o.DISPLAY.BLOCK}`},s("chi-button",{id:this.helpButtonId,onChiClick:()=>this.toggleHelpPopover(),type:"icon",size:"xs",variant:"flat","alternative-text":"Help"},s("chi-icon",{icon:"circle-info-outline",size:"xs"})),s("chi-popover",{id:this.helpPopoverId,position:"top",variant:"text",arrow:!0,reference:`#${this.helpButtonId}`},this.infoIconMessage)):null}_getInput(){return s("input",{class:`\n          ${r.INPUT}\n          ${this.indeterminate&&r.INDETERMINATE}\n          ${this._status?`-${this._status}`:""}\n        `,checked:this.checked,disabled:this.disabled,id:`${this.id}-control`,name:this.name,ref:t=>this.input=t,onChange:t=>this.toggle(t),type:"checkbox"})}_getLabel(){const t=this._getInfoIcon(),i=this.required?s("abbr",{class:"chi-label__required","aria-label":"Required field"},"*"):null;return s("label",{class:`${r.LABEL} ${this.state?`-${this.state}`:""}`,htmlFor:`${this.id}-control`},this.label,s("div",{class:n},"Select ",this.label||this.name," ",this.id),i,t)}render(){const t=this._getInput(),i=this._getLabel();return s("div",{key:"26b36f0c334fcdfc3bccd6dd75f52ea4de423c0a",class:r.checkbox},t,i,s("slot",{key:"7ea83b0572b87fc21789340c2f47e9b7fb31ead8",name:"chi-checkbox__help"}))}get el(){return e(this)}static get watchers(){return{indeterminate:["updateIndeterminate"]}}},_=class{constructor(s){t(this,s),this.eventHide=i(this,"chiDropdownHide",7),this.eventShow=i(this,"chiDropdownShow",7),this.eventKeyDown=i(this,"chiDropdownKeyDown",7),this.eventItemSelected=i(this,"chiDropdownItemSelected",7),this.eventItemDeselected=i(this,"chiDropdownItemDeselected",7),this.eventSelectionReset=i(this,"chiDropdownSelectionReset",7),this.eventValueChanged=i(this,"chiDropdownValueChanged",7),this._componentLoaded=!1,this.id=m(),this._currentDirtyItems=[],this.handlerClick=t=>{t.target===document.body||null===t.target||b(this.el,t.target)||b(this._referenceElement,t.target)||this.preventAutoHide||!this.active||this.hide()},this.handlerSelectedMenuItem=t=>{this._updateValue(t.target),this.retainSelection&&("multi"!==this.selectMode&&this.hide(),this.setActiveClassOnMenuItem())},this.handlerClickTrigger=()=>{this.toggle()},this.handlerMouseEnter=()=>{this.hover&&this.show()},this.handlerMouseLeave=()=>{this.hover&&this.hide()},this.active=!1,this.description=void 0,this.fluid=void 0,this.hover=void 0,this.button=void 0,this.icon=void 0,this.iconTooltipMessage=void 0,this.color=void 0,this.variant=void 0,this.size=void 0,this.uppercase=!1,this.disabled=!1,this.animateChevron=void 0,this.position=void 0,this.fontWeight=void 0,this.reference=void 0,this.preventAutoHide=void 0,this.preventItemSelected=!1,this.visibleItems=void 0,this.retainSelection=void 0,this.selectMode=void 0,this.state=void 0,this.helperMessage=void 0,this.items=void 0,this._menuHeader=void 0,this._menuFooter=void 0,this._forceRender=void 0,this._value=[],this._selectAllState=void 0,this._currentItems=[]}connectedCallback(){const t=this.el.querySelector('[slot="trigger"]');if(this._customTrigger=!!t,this._customTrigger)this._referenceElement=t;else if(this.reference){const t=document.querySelector(this.reference);t&&(this._referenceElement=t)}}componentDidLoad(){this._configureDropdownPopper(),this._componentLoaded=!0,this._addEventListeners(),this.setFixedWidth(),this.setMenuHeight(),v.call(this,this.onMenuItemsChange,{childList:!0,subtree:!0})}componentWillLoad(){this._getDropdownMenuSlots(),this.validateSelectMode(this.selectMode),this._setSelectModeProps(),this._updateFluidClass()}disconnectedCallback(){this._removeEventListeners()}positionValidation(t){if(t&&!f.includes(t))throw new Error(`${t} is not a valid position for Dropdown. Valid values are ${f.join(", ")}.`);this._componentLoaded&&this._configureDropdownPopper()}updateActive(t,i){t!==i&&this.setDisplay(t?"block":"none")}stateValidation(t){const i=$.join(", ");if(t&&!$.includes(t))throw new Error(`${t} is not a valid state for input. If provided, valid values are: ${i}. `)}validateSelectMode(t){if(""===t)this.selectMode="single";else if(t&&!w.includes(t))throw new Error(`${t} is not a valid select mode for Dropdown. Valid values are ${w.join(", ")}.`)}_setSelectModeProps(){this.selectMode&&(this.retainSelection=!0,this.fluid=!0),this._isSelectMulti()&&(this.preventAutoHide=!0,this.preventItemSelected=!0,this.fluid=!1,this.retainSelection=!1,this._updateMultiItems(),this._updateSelectAllCheckbox())}_updateFluidClass(){this._fluidClass=this.fluid?l:""}_updateMultiItems(){var t,i,s,e;this._currentItems=null!==(i=null===(t=this.items)||void 0===t?void 0:t.map(((t,i)=>Object.assign(Object.assign({},t),{id:t.id||this.id+"-"+i}))))&&void 0!==i?i:[],this._currentDirtyItems=null!==(e=null===(s=this._currentItems)||void 0===s?void 0:s.map((t=>Object.assign({},t))))&&void 0!==e?e:[]}async updatePopper(){this._forceRender=!this._forceRender}handleKeyDown(t){["ArrowDown","ArrowUp"].includes(t.key)&&this.active&&b(this.el,t.target)&&(t.preventDefault(),this._focusMenuItem(t.key),this.eventKeyDown.emit())}_configureDropdownPopper(){this._referenceElement?(this._initializePopper(),this._popper.update()):this._popper&&(this._popper.destroy(),this._popper=null)}_triggerElement(t){var i;const e=null===(i=this.iconTooltipMessage)||void 0===i?void 0:i.trim();return this.icon&&e?s("chi-tooltip",{wrapper:!0,message:e},t):t}_initializePopper(){this._popper=new g(this._referenceElement,this._dropdownMenuElement,{modifiers:{applyStyle:{enabled:!0},preventOverflow:{boundariesElement:"window"}},removeOnDestroy:!0,placement:this.position||"bottom"})}_getDropdownMenuSlots(){const t=this._isSelectMulti(),i=t||this.el.querySelector("[slot=menu-header]"),s=t||this.el.querySelector("[slot=menu-footer]");i&&(this._menuHeader=!0),s&&(this._menuFooter=!0)}getPadding(t){return parseInt(getComputedStyle(this._dropdownMenuElement).getPropertyValue(`padding-${t}`),10)}getTotalElementHeight(t){const i=getComputedStyle(t);return["height","margin-top","margin-bottom"].reduce(((t,s)=>t+parseInt(i.getPropertyValue(s),10)),0)}onMenuItemsChange(){this.setMenuHeight(),this._addClickEventListeners(),this.setActiveClassOnMenuItem()}setMenuHeight(){if(this.visibleItems){const t=this._dropdownMenuItemsWrapper?this._dropdownMenuItemsWrapper.children:this._dropdownMenuElement.children,i=t.length<this.visibleItems?t.length:this.visibleItems;let s=0;for(let e=0;e<i;e++)s+=this.getTotalElementHeight(t[e]);if(this._menuFooter||this._menuHeader)this._dropdownMenuItemsWrapper.style.height=`${s}px`;else{const t=this.getPadding("top")+this.getPadding("bottom");this._dropdownMenuElement.style.height=`${s+t}px`}}}setActiveClassOnMenuItem(){this._getDropdownMenuItems().forEach((t=>{const i=this._value.includes(t.textContent);t.classList.toggle(c,i)}))}setFixedWidth(){if(this.retainSelection&&this._referenceElement&&!this.fluid){const t=this._getButtonElement();t.style.width=`${this._referenceElement.offsetWidth}px`,t.classList.add(o.DISPLAY.FLEX,o.JUSTIFY.BETWEEN)}}setDisplay(t){this._dropdownMenuElement.style.display=t}emitHide(){this.eventHide.emit()}emitShow(){this.eventShow.emit()}_updateValue(t){const i=(t=t.closest(`.${d.MENU_ITEM}`)||t).innerText;if("multi"!==this.selectMode)return this._value=[i],void this.eventItemSelected.emit(i);-1===this._value.indexOf(i)?(this._value=[...this._value,i],this.eventItemSelected.emit(i)):(this._value=this._value.filter((t=>t!==i)),this.eventItemDeselected.emit(i)),this.eventValueChanged.emit(this._value)}async hide(){this.setDisplay("none"),this.active=!1,this.emitHide()}async show(){this.setDisplay("block"),this.active=!0,this._popper&&this._popper.update(),this.emitShow()}async toggle(){this.active?this.hide():this.show()}async resetSelection(){const t=this._getDropdownMenuItems();this._value=[],t.forEach((t=>{t.classList.remove(c)})),this.eventSelectionReset.emit()}_focusMenuItem(t){const i=this._getDropdownMenuItems(),s=document.activeElement,e=i.indexOf(s);let h="ArrowUp"===t?e-1:e+1;if(!i.includes(s))return i["ArrowUp"===t?i.length-1:0].focus();-1===h?h=i.length-1:h===i.length&&(h=0),i[h].focus()}_isSelectMulti(){var t;return Boolean("multi"===this.selectMode&&(null===(t=this.items)||void 0===t?void 0:t.length))}_getDropdownMenuItems(){let t=this._dropdownMenuElement.children;return this._dropdownMenuItemsWrapper&&(t=this._dropdownMenuItemsWrapper.children),Array.from(t).filter((t=>t.classList.contains(d.MENU_ITEM)))}_getButtonElement(){return this._referenceElement.querySelector("button")}_addEventListeners(){document.body.addEventListener("click",this.handlerClick.bind(this)),document.body.addEventListener("keydown",this.handleKeyDown.bind(this)),this.preventItemSelected||this._addClickEventListeners()}_removeEventListeners(){const t=this._getDropdownMenuItems();document.body.removeEventListener("click",this.handlerClick),document.body.removeEventListener("keydown",this.handleKeyDown),this.preventItemSelected||t.forEach((t=>{t.removeEventListener("click",this.handlerSelectedMenuItem)}))}_addClickEventListeners(){const t=this._getDropdownMenuItems();null==t||t.forEach((t=>{t.addEventListener("click",this.handlerSelectedMenuItem)}))}_getButtonContent(){let t=this.button;const i=this._currentItems.filter((t=>t.checked)).length;return this.icon?t=s("chi-icon",{icon:this.icon}):i?t=`(${i}) ${t}`:this.retainSelection&&this._value.length&&(t=s("span",{class:o.TYPOGRAPHY.TEXT_TRUNCATE},this._value.join(" ; "))),t}_getHelperMessage(){return this.helperMessage&&s("chi-helper-message",{state:this.state},this.helperMessage)}renderTrigger(){var t,i,e;const h=this._getButtonContent(),o=null!==(t=this.color)&&void 0!==t?t:"",n=null!==(i=this.variant)&&void 0!==i?i:"",r=null!==(e=this.size)&&void 0!==e?e:"",l=this.icon?"icon":"",c=this.button||this.icon,d=this._customTrigger?s("slot",{name:"trigger"}):null,a=s("chi-button",{onChiClick:this.handlerClickTrigger,onChiMouseEnter:this.handlerMouseEnter,fluid:this.fluid||!!this.helperMessage,"extra-class":this.getExtraClassForTriggerButton(),alternativeText:this.icon,color:o,variant:n,size:r,uppercase:this.uppercase,disabled:this.disabled,type:l,ref:t=>this._referenceElement=t},h);return c?this._triggerElement(a):d}getExtraClassForTriggerButton(){return[d.TRIGGER,this.fontWeight&&`-text--${this.fontWeight}`,this.active&&c,this.animateChevron&&a,this.icon&&d.ICON,this.selectMode&&d.SELECT_MODE,this.state&&`-b--${this.state}`].filter(Boolean).join(" ")}renderDropdownMenuHeader(t){const i=t?this.renderSelectMultiHeaderContent():s("slot",{name:"menu-header"});return this._menuHeader&&s("div",{class:`${d.MENU_HEADER} ${o.MARGIN.BOTTOM[1]}`},i)}renderDropdownMenuFooter(t){const i=t?this.renderSelectMultiFooterContent():s("slot",{name:"menu-footer"});return this._menuFooter&&s("div",{class:`${d.MENU_FOOTER} ${o.MARGIN.TOP[1]}`},i)}renderDropdownMenuItems(t){const i=t?this.renderSelectMultiItems():s("slot",{name:"menu"});return this.visibleItems&&(this._menuFooter||this._menuHeader)?s("div",{class:d.MENU_ITEMS_WRAPPER,ref:t=>this._dropdownMenuItemsWrapper=t},i):i}renderMenu(){const t=this._isSelectMulti();return s("div",{class:`\n          ${d.MENU}\n          ${o.Z_INDEX.Z_10}\n          ${this.active?c:""}\n          ${this._fluidClass}\n          ${this.description?u:""}`,ref:t=>this._dropdownMenuElement=t},this.renderDropdownMenuHeader(t),this.renderDropdownMenuItems(t),this.renderDropdownMenuFooter(t))}renderSelectMultiHeaderContent(){return s("div",{class:o.PADDING.X[1]},s("div",{class:o.PADDING.LEFT[1]},s("chi-checkbox",{label:"Select all",checked:!!this._selectAllState,indeterminate:"indeterminate"===this._selectAllState,onChiChange:()=>this._onMultiSelectAllChanged()})),s("div",{class:p.DIVIDER}))}renderSelectMultiFooterContent(){const t=[o.DISPLAY.FLEX,o.JUSTIFY.END,o.PADDING[1],o.PADDING.RIGHT[2]].join(" ");return[s("div",{class:p.DIVIDER}),s("div",{class:t},s("chi-button",{size:"xs",class:o.MARGIN.RIGHT[1],onClick:()=>this.onSelectMultiClear()},"Clear"),s("chi-button",{size:"xs",color:"primary",onClick:()=>this.onSelectMultiApply()},"Apply"))]}renderSelectMultiItems(){return this._currentDirtyItems.map((t=>s("chi-checkbox",{label:t.label,class:d.MENU_ITEM,checked:t.checked||null,name:`${this.id}-group`,id:t.id,onChiChange:i=>this._selectMultiItemClicked(i,t)})))}onSelectMultiApply(){this.hide(),this._currentItems=this._currentDirtyItems,this._currentDirtyItems=this._currentItems.map((t=>Object.assign({},t))),this.onMultiItemsChanged()}onSelectMultiClear(){this._clearMultiItemsSelection(),this._currentItems=this._currentDirtyItems.map((t=>Object.assign({},t))),this.onMultiItemsChanged()}onMultiItemsChanged(){this.eventValueChanged.emit(this._currentItems)}_clearMultiItemsSelection(){const t=Array.from(this.el.querySelectorAll("chi-checkbox[checked]"));this._currentDirtyItems.forEach((t=>t.checked=!1)),t.forEach((t=>t.removeAttribute("checked"))),this._updateSelectAllCheckbox()}_selectAllMultiItems(){this._currentDirtyItems.forEach((t=>t.checked=!0)),this._updateSelectAllCheckbox()}_selectMultiItemClicked(t,i){t.stopPropagation(),i.checked=!i.checked,this._updateSelectAllCheckbox()}_onMultiSelectAllChanged(){this._selectAllState?this._clearMultiItemsSelection():this._selectAllMultiItems()}_updateSelectAllCheckbox(){const t=this._currentDirtyItems.filter((t=>t.checked)).length;this._selectAllState=t&&t<this._currentDirtyItems.length?"indeterminate":t===this._currentDirtyItems.length}render(){const t=this.renderTrigger(),i=this.renderMenu();return t?s("div",{class:`\n        ${d.DROPDOWN}\n        ${this.active?c:""}\n        ${this._fluidClass}`,onMouseLeave:this.handlerMouseLeave},t,this.helperMessage&&this._getHelperMessage(),i):i}get el(){return e(this)}static get watchers(){return{position:["positionValidation"],active:["updateActive"],state:["stateValidation"],selectMode:["_setSelectModeProps"],fluid:["_updateFluidClass"],items:["_updateMultiItems"]}}};_.style="chi-dropdown.sc-chi-dropdown-h{display:-ms-flexbox;display:flex}";export{C as chi_checkbox,_ as chi_dropdown}