import{r as t,c as i,h as s,H as e,g as h}from"./p-1fb7f4e7.js";import{w as r,c as n,U as o,n as a,D as l,l as c,x as d,I as u,G as f}from"./p-70488c96.js";import{T as p,A as b}from"./p-3c5e39a4.js";import{T as v,a as g}from"./p-0019854f.js";import{T as m}from"./p-1ef4f618.js";import{T as w}from"./p-68882606.js";import{v as $}from"./p-d1e6806c.js";class T{static deepEqual(t,i){if(typeof t!=typeof i)return!1;if(null==t||null==i)return t===i;if("object"==typeof t){if(Object.keys(t).length!==Object.keys(i).length)return!1;for(const s in t)if(!this.deepEqual(t[s],i[s]))return!1;return!0}return t===i}static isEmpty(t){return Array.isArray(t)&&this.isEmptyArray(t)||!this.hasProperties(t)||!Object.keys(t).some((i=>Array.isArray(t[i])?t[i].length>0:t[i]===Object(t[i])?!this.isEmpty(t[i]):null!=t[i]&&""!==t[i]))}static isEmptyArray(t=[]){return!t||0===t.length}static hasProperties(t){for(const i in t)return!!i;return!1}}const y=class{sizeValidation(t){const i=m.join(", ");if(t&&!m.includes(t))throw new Error(`${t} is not a valid size for tabs. Valid values are: ${i}. `)}setTabs(t,i){T.deepEqual(t,i)||(this.currentTabs=t||[])}activeTabChanged(t){this.activeTabValidation();let i=this.tabs.find((i=>i.id===t)),s=this.el.querySelector(`#${t}`);if(!i){const e=this.findParentTab(this.tabs,t);if(!e)throw new Error(`Tried to set active-tab with id '${t}' but it was not found`);i={id:t},s=this.el.querySelector(`li#${e.id} a`)}this.changeTab(i,s),this.chiTabChange.emit(i)}constructor(s){t(this,s),this.chiTabChange=i(this,"chiTabChange",7),this.activeTab="",this.slidingBorder=!1,this.border=!1,this.solid=!1,this.vertical=!1,this.size="md",this.seeMoreMessage=p,this.inverse=!1,this.extraClass="",this.sliding=!1,this.isSeeMoreActive=!1,this.isSeeMoreVisible=!1,this.isSeeMoreTriggerMeasured=!1,this.currentTabs=[],this.activePanel="",this.activeTabElement=null,this.availableSpace=0,this.dropdownKey=0,this.slidingBorderElement=null,this.lisArrayLength=0,this.liSizes={},this.seeMoreTriggerElementWidth=0,this.uuid4=$(),this.seeMoreTriggerId=`see-more-trigger-${this.uuid4}`,this.dropdownKeys={},this.handlerClickSeeMore=t=>{if(t.preventDefault(),this.isSeeMoreActive=!this.isSeeMoreActive,!this.seeMoreDropdown){const t=document.getElementById(`${this.uuid4}-see-more-dropdown`);this.seeMoreDropdown=t}this.seeMoreDropdown.toggle()},this.handlerResize=()=>{this._setSeeMoreTriggerElement(),this.setAvailableSpace(),this.setListOverflow(),this.activeTabElement=this.getActiveTabTrigger(),this.setSlidingBorderStyles(),this.hideAllDropdowns()},this.handlerTabMouseEnter=t=>{if(this.hideInactiveDropdowns(t),!t.children||t.disabled)return;this.dropdownKeys[t.id]+=1;const i=this.getSubLevelDropdown(t.id);i&&i.show()},this.handlerMouseLeave=(t,i)=>{Array.from(document.getElementsByClassName(i?a.MENU:a.MENU_ITEM)).some((i=>i===t.relatedTarget))||this.hideAllDropdowns()},this.liMarginLeft="lg"===this.size?32:24}componentWillLoad(){this.sizeValidation(this.size),this.activeTabValidation()}connectedCallback(){var t;this.currentTabs=null!==(t=this.tabs)&&void 0!==t?t:[]}componentDidLoad(){this.vertical||(this.setAvailableSpace(),this.setLiSizes(),this.seeMoreTriggerElementWidth=this.calculateSize(this.seeMoreTriggerElement,v.Width)+(this.solid?0:this.liMarginLeft),this.isSeeMoreTriggerMeasured=!0,this.activeTabElement=this.getActiveTabTrigger(),this.setSlidingBorderStyles(),window.addEventListener("resize",this.handlerResize)),this.setActivePanelId(this.currentTabs),this.activatePanel(this.activePanel)}componentDidUpdate(){this.setAvailableSpace(),this.setLiSizes()}disconnectedCallback(){window.removeEventListener("resize",this.handlerResize)}activeTabValidation(){const t=this.findTab(this.tabs,this.activeTab);if(t&&t.disabled)throw new Error(`Disabled tab (#${t.id}) cannot be set as active`)}activateTab(t,i){this.activeTab=t.id,this.activeTabElement=i}setActivePanelId(t){t.forEach((t=>{t.id===(null==this?void 0:this.activeTab)?this.activePanel=t.id:t.children&&this.setActivePanelId(t.children)}))}activatePanel(t){var i,s;t&&(null===(i=this.el.querySelector(`.${r.PANEL}.${n}`))||void 0===i||i.classList.remove(n),null===(s=this.el.querySelector(`.${r.PANEL}#${t}`))||void 0===s||s.classList.add(n))}calculateSize(t,i){return t?t.getBoundingClientRect()[i]:0}setParentTabActive(t){document.getElementById(t.parent?t.parent.id:t.id).classList.add(n),t.parent&&this.setParentTabActive(t.parent)}findParentTab(t,i){return null==t?void 0:t.find((t=>t.id===i||t.children&&this.findParentTab(t.children,i)?t:void 0))}findTab(t,i){return null==t?void 0:t.find((t=>t.id===i?t:this.findTab(t.children,i)))}removeActiveItems(){Object.keys(this.dropdownKeys).forEach((t=>{const i=document.getElementById(t);i&&i.classList.contains(n)&&i.classList.remove(n)}))}createDropdowns(t,i,s){const e=[];return t.forEach((t=>{const h=0===i,r=h?t.id:s;t.children&&t.children.length>0&&!t.disabled&&(this.dropdownKeys[t.id]=0,e.push(this.getDropdown(t,h,r)),e.push(...this.createDropdowns(t.children,i+1,r)))})),e}getDropdown(t,i,e){return s("chi-dropdown",{id:`subLevelDropdown-${t.id}`,position:i?"bottom-start":"right-start",reference:`#${t.id}`,"visible-items":t.visibleItems,key:`${t.id}-${this.dropdownKey}`},this.getDropdownMenuItems(t,e))}getDropdownMenuItems(t,i){return t.children.map((s=>(s.parent=t,this.getDropdownMenuItem(s,(e=>this.onDropdownMenuItemClick(e,t,s,i)),o.JUSTIFY.BETWEEN))))}getDropdownMenuItem(t,i,e=""){return s("a",{class:`${a.MENU_ITEM} \n          ${e} \n          ${this._isActiveTab(t)?n:""}\n          ${t.disabled?l:""}\n        `,id:t.id,href:this.getTabHref(t),target:this.getTabHrefTarget(t),onMouseEnter:()=>this.handlerTabMouseEnter(t),onMouseLeave:t=>this.handlerMouseLeave(t),onClick:t=>i(t),innerHTML:t.label,slot:"menu"},t.children&&t.children.length>0&&this.dropdownIcon("right"))}onDropdownMenuItemClick(t,i,s,e){const h=this.getSubLevelDropdown(i.id),r=this.el.querySelector(`li#${e} a`);this.handlerClickTab(t,s,r),this.isSeeMoreActive=!1,h&&(this.setParentTabActive(s),h.hide())}getActiveTabTrigger(){return this.el.querySelector(`li.${n}`)}getSubLevelDropdown(t){return this.el.querySelector(`chi-dropdown#subLevelDropdown-${t}`)}getTabHref(t){var i;let s=t.href||`#${t.id}`;return(null===(i=t.href)||void 0===i?void 0:i.startsWith("www."))&&(s="//"+s),s}getTabHrefTarget(t){let i=t.target||"";return this.isTabInternalLink(t)||i||(i="_blank"),i}isTabInternalLink(t){return!t.href||t.href.startsWith("#")}getPosition(t){const i=window.getComputedStyle(t),s=i.getPropertyValue("margin-top"),e=i.getPropertyValue("margin-left");return{left:t.offsetLeft-parseInt(e),top:t.offsetTop-parseInt(s)}}handlerClickTab(t,i,s){if((this.isTabInternalLink(i)||i.disabled)&&t.preventDefault(),i.disabled)return;this.animation&&!this.animation.isStopped()&&this.animation.stop();const e=s||t.target;this.slidingBorder&&this.setAnimation(e),this.changeTab(i,e)}changeTab(t,i){this.removeActiveItems(),this.activateTab(t,i),this.activatePanel(t.id)}setAnimation(t){const i=this.getPosition(t);this.animation=w.animationFactory((()=>{this.sliding=!0}),(()=>{const s=this.getSlidingBorderAnimationStyle(),e=this.calculateSize(t,s.dimension);this.slidingBorderElement.style[s.direction]=`${i[s.direction]}px`,this.slidingBorderElement.style[s.dimension]=`${e}px`}),(()=>{this.slidingBorderElement.style.width="",this.sliding=!1}),b.MEDIUM)}getSlidingBorderAnimationStyle(){return this.vertical?{dimension:v.Height,direction:g.Top}:{dimension:v.Width,direction:g.Left}}getParentIds(t){const i=[],s=t=>{t.parent&&(i.push(t.parent.id),s(t.parent))};return s(t),i}hideInactiveDropdowns(t){const i=[...this.getParentIds(t),t.id],s=Object.keys(this.dropdownKeys).filter((t=>!i.includes(t)));this.hideSelectedDropdowns(s)}hideDropdown(){this.isSeeMoreActive=!1}_isActiveTab(t){let i=t.id===this.activeTab;return!i&&t.children&&(i=t.children.some((t=>this._isActiveTab(t)))),!t.disabled&&i}isActiveTabOverflown(t){return t.some((t=>this._isActiveTab(t)&&!!t.overflow))}_setSeeMoreTriggerElement(){if(!this.seeMoreTriggerElement){const t=document.getElementById(this.seeMoreTriggerId);this.seeMoreTriggerElement=t}}setAvailableSpace(){this.availableSpace=this.calculateSize(this.el,v.Width)}async setLiSizes(){var t;const i=null===(t=this.ulElement)||void 0===t?void 0:t.querySelectorAll(`li.${r.TRIGGER}`);this.lisArrayLength=this.currentTabs.length,await(null==i?void 0:i.forEach(((t,i)=>{this.liSizes[t.dataset.index]=this.calculateSize(t,v.Width)+(0===i||this.solid?0:this.liMarginLeft)}))),this.setListOverflow()}setListOverflow(){if(this.vertical)return;const t=this._stringifyTabs(this.currentTabs);let i=0;this.isSeeMoreVisible=!1;for(let t=0;t<this.lisArrayLength;t++)!this.isSeeMoreVisible&&i+this.liSizes[t]+(t+1===this.lisArrayLength?0:this.seeMoreTriggerElementWidth)<=this.availableSpace?(i+=this.liSizes[t],this.currentTabs[t].overflow=!1):(this.currentTabs[t].overflow=!0,this.isSeeMoreVisible=!0);this._stringifyTabs(this.currentTabs)!==t&&(this.dropdownKey+=1)}_stringifyTabs(t){const i=t=>{const{children:s,id:e,label:h,overflow:r,target:n,href:o}=t;return{children:null==s?void 0:s.map(i),id:e,label:h,overflow:r,target:n,href:o}};return JSON.stringify(t.map(i))}setSlidingBorderStyles(){if(!this.activeTab)return;const t=this.isActiveTabOverflown(this.currentTabs)?this.seeMoreTriggerElement:this.activeTabElement,i=this.getPosition(t);this.slidingBorderLeft=`${i.left}px`}hideDropdowns(t){t.forEach((t=>{const i=this.getSubLevelDropdown(t);i&&i.hide()}))}hideAllDropdowns(){this.hideDropdowns(Object.keys(this.dropdownKeys))}hideSelectedDropdowns(t){this.hideDropdowns(t)}dropdownIcon(t){return s("i",{class:`${u} ${o.MARGIN.LEFT[2]} ${o.MARGIN.RIGHT[0]} icon-chevron-${t} ${f.XS}`,"aria-hidden":"true"})}getTabElements(){var t;const i=[];return null===(t=this.currentTabs)||void 0===t||t.forEach(((t,e)=>{t.overflow||i.push(s("li",{class:`${r.TRIGGER} ${this._isActiveTab(t)?n:""} ${t.disabled?l:""}`,"data-index":e,id:t.id,onMouseEnter:()=>{this.hideAllDropdowns(),this.handlerTabMouseEnter(t)}},s("a",{href:this.getTabHref(t),target:this.getTabHrefTarget(t),class:t.children?"-has-child":"",role:"tab","aria-selected":this._isActiveTab(t),"aria-controls":`#${t.id}`,onClick:i=>this.handlerClickTab(i,t),innerHTML:t.label})))})),i}getSlidingBorder(){return this.slidingBorder?s("li",{class:r.SLIDING_BORDER,ref:t=>this.slidingBorderElement=t,style:{left:this.slidingBorderLeft}}):null}getSeeMoreTrigger(){const t=this.isActiveTabOverflown(this.currentTabs)?n:"";return!this.vertical&&(this.isSeeMoreVisible||!this.isSeeMoreTriggerMeasured)&&s("li",{class:`${r.SHOW_MORE} ${t}`,id:this.seeMoreTriggerId,ref:t=>this.seeMoreTriggerElement=t},s("a",{href:"#seeMore",role:"tab",onClick:t=>this.handlerClickSeeMore(t),ref:t=>this.seeMoreTriggerAnchorElement=t},this.seeMoreMessage))}getOverflowItems(){return this.currentTabs.filter((t=>t.overflow)).map((t=>this.getDropdownMenuItem(t,(i=>{this.handlerClickTab(i,t,this.seeMoreTriggerAnchorElement),this.seeMoreDropdown.hide(),this.isSeeMoreActive=!1}))))}getDropdowns(){return this.vertical?[]:[this.isSeeMoreVisible&&s("chi-dropdown",{active:this.isSeeMoreActive,id:`${this.uuid4}-see-more-dropdown`,key:this.dropdownKey,position:"bottom",reference:`#${this.seeMoreTriggerId}`,ref:t=>this.seeMoreDropdown=t},this.getOverflowItems()),...this.createDropdowns(this.currentTabs,0)]}getPanels(){return s("slot",{name:"panels"})}getListClasses(){return[r.TABS,this.slidingBorder&&r.ANIMATE,this.border&&r.BORDER,this.vertical&&r.VERTICAL,this.solid&&r.SOLID,this.sliding&&r.SLIDING,this.size&&`-${this.size}`,this.inverse&&c,this.extraClass].filter(Boolean).join(" ")}getTabs(){const t=this.getTabElements(),i=this.getSlidingBorder(),e=this.getSeeMoreTrigger();return s("ul",{class:this.getListClasses(),ref:t=>{this.ulElement=t},onMouseLeave:t=>this.handlerMouseLeave(t,!0),role:"tablist"},t,e,i)}getChiGridLayout(t,i,h){return s(e,null,s("div",{class:`${d.GRID} ${d.NO_GUTTER}`},s("div",{class:d.COL},t,i),h))}render(){const t=this.getDropdowns(),i=this.getPanels(),h=this.getTabs();return this.vertical&&this.el.querySelector('[slot="panels"] .chi-tabs-panel')?this.getChiGridLayout(h,t,i):s(e,null,h,t,i)}get el(){return h(this)}static get watchers(){return{size:["sizeValidation"],tabs:["setTabs"],activeTab:["activeTabChanged"]}}};y.style="chi-tabs.sc-chi-tabs-h{display:block}";export{y as chi_tabs}