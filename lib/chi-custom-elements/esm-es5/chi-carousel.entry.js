import{r as registerInstance,c as createEvent,h,g as getElement}from"./index-c11192ea.js";import{a as TRANSITIONING_CLASS,S as STAT_CLASSES,b as CAROUSEL_CLASSES,c as ACTIVE_CLASS,U as UTILITY_CLASSES}from"./classes-6227bd8c.js";import{C as CAROUSEL_SWIPE_DELTA,a as CAROUSEL_DIRECTION,A as ANIMATION_DURATION}from"./constants-0e68989c.js";import{T as ThreeStepsAnimation}from"./ThreeStepsAnimation-a718d5b8.js";var carouselCss="chi-carousel.sc-chi-carousel-h{display:block;width:100%}";var ChiCarouselStyle0=carouselCss;var CAROUSEL_BOUNCE_DISTANCE=25;var CAROUSEL_BOUNCE_TIME=200;var MAX_ITEMS_THRESHOLD=.95;var Carousel=function(){function t(t){var i=this;registerInstance(this,t);this.chiViewChange=createEvent(this,"chiViewChange",7);this.scrollBreakpoints={0:CAROUSEL_BOUNCE_DISTANCE};this.isDragging=false;this.currentStep=0;this.remainingSpace=0;this.isLastView=false;this.isLastStep=false;this.restItemsShown=0;this.resizeHandler=function(){i._calculateCarouselWidth()};this.touchEnd=function(){if(i.isDragging){i.isDragging=false;i.wrapper.style.transform=i.getWrapperTransform()}};this.touchMove=function(t){if(i.isDragging){var s=i.getPositionX(t);var h=i.scrollBreakpoints[i.view+1];var n=i.getMoveDelta();var e=i.isMoveToNext()?h-n:h+n;i.moveEndPosition=s;i.wrapper.style.transform="translateX(".concat(e,"px)");if(n>CAROUSEL_SWIPE_DELTA){if(i.isMoveToNext()){i.nextView()}else{i.prevView()}i.isDragging=false}}};this.touchStart=function(t){i.moveStartPosition=i.getPositionX(t);i.isDragging=true};this.getPositionX=function(t){return t.touches[0].clientX};this.dots=undefined;this.autoplay=undefined;this.interval=5;this.pagination=undefined;this.noButtonControllers=false;this.single=undefined;this.view=0;this.numberOfViews=0;this.maxItemsShown=undefined;this.customPrevButton=undefined;this.customNextButton=undefined;this.autoplayInterval=undefined;this.transformX=0}t.prototype._calculateCarouselWidth=function(){var t=this._getCarouselItems();this.fullScrollLength=this.el.offsetWidth||this.fullScrollLength;if(this.single){this._applySizeToItems();this.transformX=-(this.currentStep*t[0].offsetWidth)}var i=this.fullScrollLength/t[0].offsetWidth;this.maxItemsShown=i%1>MAX_ITEMS_THRESHOLD?Math.ceil(i):Math.floor(i);this.numberOfViews=Math.ceil(t.length/this.maxItemsShown);this.restItemsShown=t.length%this.maxItemsShown;if(this.isLastView){this._calculateView(CAROUSEL_DIRECTION.NEXT,this.currentStep)}};t.prototype.connectedCallback=function(){this.customPrevButton=!!this.el.querySelector('[slot="previous"]');this.customNextButton=!!this.el.querySelector('[slot="next"]')};t.prototype.componentDidLoad=function(){this._calculateCarouselWidth();this._autoPlay(false);window.addEventListener("resize",this.resizeHandler)};t.prototype.componentWillOnload=function(){window.removeEventListener("resize",this.resizeHandler)};t.prototype._autoPlay=function(t){var i=this;if(this.autoplay&&!this.autoplayInterval&&!t){this.autoplayInterval=window.setInterval((function(){if(i.view===i.numberOfViews-1){i._goToView(-1)}i._goToView(++i.view)}),this.interval*1e3)}else{window.clearInterval(this.autoplayInterval);this.autoplayInterval=null}};t.prototype._calculateView=function(t,i){var s=this._getCarouselItems();var h=s[0].offsetWidth;var n=i!==undefined?i:this.maxItemsShown*-t+this.currentStep;var e=s.length-n;var r=this.isLastView;this.isLastView=e<=this.maxItemsShown;this.isLastStep=e<=0;if(n<0)n=0;if(this.isLastStep&&t===CAROUSEL_DIRECTION.NEXT)return;if(this.isLastView){this._moveLastView(i,e,h)}else if(n===0){this.transformX=0}else{this._moveView(i,h,n,t,r)}if(n>=0){this.currentStep=Math.abs(n)}};t.prototype._moveView=function(t,i,s,h,n){if(t){this.transformX=t*i*-1}else{var e=this._getGap();this.transformX+=n?this.remainingSpace:(Math.abs(s-this.currentStep)*i+e*this.maxItemsShown)*h}};t.prototype._moveLastView=function(t,i,s){var h=this._getGap();var n=this.maxItemsShown+i;this.remainingSpace=Math.abs(this.fullScrollLength-n*s-h*n-h/3);if(t){this.transformX=this.fullScrollLength-(t+i)*s}else{this.transformX-=this.remainingSpace}};t.prototype._bounceView=function(t){var i=this;if(this.isLastStep){this.transformX+=CAROUSEL_BOUNCE_DISTANCE*t}else{this.transformX=CAROUSEL_BOUNCE_DISTANCE*t}setTimeout((function(){i.transformX-=CAROUSEL_BOUNCE_DISTANCE*t}),CAROUSEL_BOUNCE_TIME)};t.prototype.prevView=function(){var t=this;this._calculateView(CAROUSEL_DIRECTION.PREVIOUS);if(this.animation&&!this.animation.isStopped()){this.animation.stop()}if(this.view>=-1){this.animation=ThreeStepsAnimation.animationFactory((function(){t._animationClasses="".concat(TRANSITIONING_CLASS)}),(function(){if(t.view>=0){t.view=t.view-1}}),(function(){if(t.view===-1){t.view=0}else{t._animationClasses="";t.chiViewChange.emit(t.view)}}),ANIMATION_DURATION.SHORT)}if(this.currentStep===0||this.isLastStep){this._bounceView(CAROUSEL_DIRECTION.PREVIOUS)}};t.prototype.nextView=function(){var t=this;this._calculateView(CAROUSEL_DIRECTION.NEXT);if(this.animation&&!this.animation.isStopped()){this.animation.stop()}this.animation=ThreeStepsAnimation.animationFactory((function(){t._animationClasses="".concat(TRANSITIONING_CLASS)}),(function(){if(t.view<t.numberOfViews){t.view=t.view+1}}),(function(){if(t.view===t.numberOfViews){t.view=t.numberOfViews-1}else{t.chiViewChange.emit(t.view);t._animationClasses=""}}),ANIMATION_DURATION.SHORT);if(this.currentStep===0||this.isLastStep){this._bounceView(CAROUSEL_DIRECTION.NEXT)}};t.prototype.isMoveToNext=function(){return this.moveStartPosition>this.moveEndPosition};t.prototype.getMoveDelta=function(){return Math.abs(this.moveEndPosition-this.moveStartPosition)};t.prototype.getWrapperTransform=function(){return"translateX(".concat(this.transformX,"px)")};t.prototype._applySizeToItems=function(){var t=this;var i=this._getCarouselItems();if(i){i.forEach((function(i){i.style.width="".concat(t.fullScrollLength,"px")}))}};t.prototype._goToView=function(t){var i=this.maxItemsShown*t;var s=i>this.currentStep?CAROUSEL_DIRECTION.NEXT:CAROUSEL_DIRECTION.PREVIOUS;this._calculateView(s,i);this.view=t;this.chiViewChange.emit(t)};t.prototype._getCarouselItems=function(){var t=[CAROUSEL_CLASSES.ITEM,STAT_CLASSES.ITEM];return this.el.querySelectorAll(t.map((function(t){return".".concat(t)})).join(", "))};t.prototype._areThereMultipleItems=function(){var t=this._getCarouselItems();return t.length>1};t.prototype._getItemVisibility=function(t){var i=this.view*this.maxItemsShown;var s=i+this.maxItemsShown;if(this.isLastView&&this.restItemsShown>0){i=i-(this.maxItemsShown-this.restItemsShown)}return t>=i&&t<s};t.prototype.setVisibleClass=function(){var t=this;var i=this._getCarouselItems();i.forEach((function(i,s){var h=t._getItemVisibility(s);i.classList.toggle("-visible",h)}))};t.prototype._getStatComponent=function(){return this.el.querySelector(".".concat(STAT_CLASSES.STAT))};t.prototype._getGap=function(){var t=this._getStatComponent();if(t){var i=window.getComputedStyle(t);return parseInt(i.gap,10)}return 0};t.prototype.render=function(){var t=this;this.setVisibleClass();var i=this._areThereMultipleItems()&&!this.noButtonControllers&&h("div",{class:"".concat(CAROUSEL_CLASSES.CONTROL," ").concat(CAROUSEL_CLASSES.PREVIOUS),onClick:function(){return t.prevView()}},this.customPrevButton?h("slot",{name:"previous"}):h("chi-button",{size:"sm",type:"float","alternative-text":"Carousel previous",disabled:this.currentStep<=0},h("chi-icon",{icon:"chevron-left"})));var s=this._areThereMultipleItems()&&!this.noButtonControllers&&h("div",{class:"".concat(CAROUSEL_CLASSES.CONTROL," ").concat(CAROUSEL_CLASSES.NEXT),onClick:function(){return t.nextView()}},this.customNextButton?h("slot",{name:"next"}):h("chi-button",{size:"sm",type:"float","alternative-text":"Carousel next",disabled:this.isLastView},h("chi-icon",{icon:"chevron-right"})));var n=h("slot",{name:"items"});var e=this.dots?h("div",{class:CAROUSEL_CLASSES.DOTS},Array(this.numberOfViews).fill(0).map((function(i,s){return h("span",{onClick:function(){t._goToView(s)},class:"\n              ".concat(CAROUSEL_CLASSES.DOT,"\n              ").concat(t.view===s||t.view===-1&&s===0||t.view===t.numberOfViews&&s===t.numberOfViews-1?ACTIVE_CLASS:"")})}))):null;var r=this.pagination?h("div",{class:CAROUSEL_CLASSES.PAGINATION},this.view===0||this.view===-1?1:this.view+1>this.numberOfViews?this.numberOfViews:this.view+1," ","of ",this.numberOfViews):null;return h("div",{onTouchStart:this.touchStart,onTouchEnd:this.touchEnd,onTouchMove:this.touchMove,onMouseEnter:function(){return t._autoPlay(true)},onMouseLeave:function(){return t._autoPlay(false)},class:"\n        ".concat(CAROUSEL_CLASSES.CAROUSEL,"\n        ").concat(this.dots?CAROUSEL_CLASSES.DOTS_ADDITION:"","\n        ").concat(this.pagination?CAROUSEL_CLASSES.PAGINATION_ADDITION:"")},h("div",{class:CAROUSEL_CLASSES.CONTENT},h("div",{class:"\n            ".concat(CAROUSEL_CLASSES.WRAPPER,"\n            ").concat(this._animationClasses,"\n            ").concat(this.single?UTILITY_CLASSES.DISPLAY.FLEX:"","\n          "),style:{transform:this.getWrapperTransform()},ref:function(i){return t.wrapper=i}},n)),i,s,e,r)};Object.defineProperty(t.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});return t}();Carousel.style=ChiCarouselStyle0;export{Carousel as chi_carousel};