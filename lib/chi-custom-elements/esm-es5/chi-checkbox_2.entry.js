var __awaiter=this&&this.__awaiter||function(t,i,n,s){function e(t){return t instanceof n?t:new n((function(i){i(t)}))}return new(n||(n=Promise))((function(n,r){function h(t){try{a(s.next(t))}catch(t){r(t)}}function o(t){try{a(s["throw"](t))}catch(t){r(t)}}function a(t){t.done?n(t.value):e(t.value).then(h,o)}a((s=s.apply(t,i||[])).next())}))};var __generator=this&&this.__generator||function(t,i){var n={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},s,e,r,h;return h={next:o(0),throw:o(1),return:o(2)},typeof Symbol==="function"&&(h[Symbol.iterator]=function(){return this}),h;function o(t){return function(i){return a([t,i])}}function a(o){if(s)throw new TypeError("Generator is already executing.");while(h&&(h=0,o[0]&&(n=0)),n)try{if(s=1,e&&(r=o[0]&2?e["return"]:o[0]?e["throw"]||((r=e["return"])&&r.call(e),0):e.next)&&!(r=r.call(e,o[1])).done)return r;if(e=0,r)o=[o[0]&2,r.value];switch(o[0]){case 0:case 1:r=o;break;case 4:n.label++;return{value:o[1],done:false};case 5:n.label++;e=o[1];o=[0];continue;case 7:o=n.ops.pop();n.trys.pop();continue;default:if(!(r=n.trys,r=r.length>0&&r[r.length-1])&&(o[0]===6||o[0]===2)){n=0;continue}if(o[0]===3&&(!r||o[1]>r[0]&&o[1]<r[3])){n.label=o[1];break}if(o[0]===6&&n.label<r[1]){n.label=r[1];r=o;break}if(r&&n.label<r[2]){n.label=r[2];n.ops.push(o);break}if(r[2])n.ops.pop();n.trys.pop();continue}o=i.call(t,n)}catch(t){o=[6,t];e=0}finally{s=r=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};var __spreadArray=this&&this.__spreadArray||function(t,i,n){if(n||arguments.length===2)for(var s=0,e=i.length,r;s<e;s++){if(r||!(s in i)){if(!r)r=Array.prototype.slice.call(i,0,s);r[s]=i[s]}}return t.concat(r||Array.prototype.slice.call(i))};import{r as registerInstance,c as createEvent,h,g as getElement}from"./index-422a57bb.js";import{X as LABEL_CLASSES,U as UTILITY_CLASSES,Y as SR_ONLY,g as CHECKBOX_CLASSES,Z as FLUID_CLASS,b as ACTIVE_CLASS,h as DROPDOWN_CLASSES,_ as ANIMATE_CLASS,$ as LIST_CLASS,i as DIVIDER_CLASSES}from"./classes-d4369523.js";import{a as addMutationObserver}from"./mutationObserver-46245962.js";import{v as v4}from"./v4-a4ec28c0.js";import{P as Popper}from"./popper-8e2de18f.js";import{a as CARDINAL_EXTENDED_POSITIONS}from"./positions-82cba14e.js";import{c as contains}from"./utils-48628cb4.js";import{D as DROPDOWN_SELECT_MODES}from"./types-870494ef.js";import{C as CHI_STATES}from"./states-a5be3f93.js";var Checkbox=function(){function t(t){registerInstance(this,t);this.chiChange=createEvent(this,"chiChange",7);this.required=false;this.infoIcon=false;this.infoIconMessage=""}t.prototype.connectedCallback=function(){var t;this.id=(t=this.el.getAttribute("id"))!==null&&t!==void 0?t:v4();addMutationObserver.call(this)};t.prototype.componentWillLoad=function(){this.helpButtonId="help-button-".concat(v4());this.helpPopoverId="help-popover-".concat(v4())};t.prototype.componentDidLoad=function(){this._updateIndeterminate()};t.prototype.toggle=function(t){this.checked=t.target.checked;this.indeterminate=false;this._emitChange(this.checked)};t.prototype._emitChange=function(t){this.chiChange.emit(t)};t.prototype._updateIndeterminate=function(){this.input.indeterminate=this.indeterminate};t.prototype.updateIndeterminate=function(t,i){if(t!==i){this._updateIndeterminate()}};t.prototype.toggleHelpPopover=function(){this.el.querySelector("#".concat(this.helpPopoverId)).toggle()};t.prototype._getInfoIcon=function(){var t=this;return this.infoIcon?h("div",{class:"".concat(LABEL_CLASSES.HELP," ").concat(UTILITY_CLASSES.DISPLAY.BLOCK)},h("chi-button",{id:this.helpButtonId,onChiClick:function(){return t.toggleHelpPopover()},type:"icon",size:"xs",variant:"flat","alternative-text":"Help"},h("chi-icon",{icon:"circle-info-outline",size:"xs"})),h("chi-popover",{id:this.helpPopoverId,position:"top",variant:"text",arrow:true,reference:"#".concat(this.helpButtonId)},this.infoIconMessage)):null};t.prototype._getInput=function(){var t=this;return h("input",{class:"\n          ".concat(CHECKBOX_CLASSES.INPUT,"\n          ").concat(this.indeterminate&&CHECKBOX_CLASSES.INDETERMINATE,"\n          ").concat(this._status?"-".concat(this._status):"","\n        "),checked:this.checked,disabled:this.disabled,id:"".concat(this.id,"-control"),name:this.name,ref:function(i){return t.input=i},onChange:function(i){return t.toggle(i)},type:"checkbox"})};t.prototype._getLabel=function(){var t=this._getInfoIcon();var i=this.required?h("abbr",{class:"chi-label__required","aria-label":"Required field"},"*"):null;return h("label",{class:"".concat(CHECKBOX_CLASSES.LABEL," ").concat(this.state?"-".concat(this.state):""),htmlFor:"".concat(this.id,"-control")},this.label,h("div",{class:SR_ONLY},"Select ",this.label||this.name," ",this.id),i,t)};t.prototype.render=function(){var t=this._getInput();var i=this._getLabel();return h("div",{key:"b48f5e4ccb29b9b208fd337fc600d26d22fe27bb",class:CHECKBOX_CLASSES.checkbox},t,i,h("slot",{key:"1049006e09c4a23b54c7ba206a41fea4a906680f",name:"chi-checkbox__help"}))};Object.defineProperty(t.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{indeterminate:["updateIndeterminate"]}},enumerable:false,configurable:true});return t}();var dropdownCss="chi-dropdown.sc-chi-dropdown-h{display:-ms-flexbox;display:flex}";var ChiDropdownStyle0=dropdownCss;var Dropdown=function(){function t(t){var i=this;registerInstance(this,t);this.eventHide=createEvent(this,"chiDropdownHide",7);this.eventShow=createEvent(this,"chiDropdownShow",7);this.eventKeyDown=createEvent(this,"chiDropdownKeyDown",7);this.eventItemSelected=createEvent(this,"chiDropdownItemSelected",7);this.eventItemDeselected=createEvent(this,"chiDropdownItemDeselected",7);this.eventSelectionReset=createEvent(this,"chiDropdownSelectionReset",7);this.eventValueChanged=createEvent(this,"chiDropdownValueChanged",7);this.active=false;this.uppercase=false;this.disabled=false;this.preventItemSelected=false;this._value=[];this._currentItems=[];this._componentLoaded=false;this.id=v4();this._currentDirtyItems=[];this.handlerClick=function(t){if(t.target!==document.body&&t.target!==null&&!contains(i.el,t.target)&&!contains(i._referenceElement,t.target)&&!i.preventAutoHide&&i.active){i.hide()}};this.handlerSelectedMenuItem=function(t){i._updateValue(t.target);if(i.retainSelection){if(i.selectMode!=="multi"){i.hide()}i.setActiveClassOnMenuItem()}};this.handlerClickTrigger=function(){i.toggle()};this.handlerMouseEnter=function(){if(i.hover){i.show()}};this.handlerMouseLeave=function(){if(i.hover){i.hide()}}}t.prototype.connectedCallback=function(){var t=this.el.querySelector('[slot="trigger"]');this._customTrigger=!!t;if(this._customTrigger){this._referenceElement=t}else if(this.reference){var i=document.querySelector(this.reference);if(i){this._referenceElement=i}}};t.prototype.componentDidLoad=function(){this._configureDropdownPopper();this._componentLoaded=true;this._addEventListeners();this.setFixedWidth();this.setMenuHeight();addMutationObserver.call(this,this.onMenuItemsChange,{childList:true,subtree:true})};t.prototype.componentWillLoad=function(){this._getDropdownMenuSlots();this.validateSelectMode(this.selectMode);this._setSelectModeProps();this._updateFluidClass()};t.prototype.disconnectedCallback=function(){this._removeEventListeners()};t.prototype.positionValidation=function(t){if(t&&!CARDINAL_EXTENDED_POSITIONS.includes(t)){throw new Error("".concat(t," is not a valid position for Dropdown. Valid values are ").concat(CARDINAL_EXTENDED_POSITIONS.join(", "),"."))}if(this._componentLoaded){this._configureDropdownPopper()}};t.prototype.updateActive=function(t,i){if(t!==i){if(t){this.setDisplay("block")}else{this.setDisplay("none")}}};t.prototype.stateValidation=function(t){var i=CHI_STATES.join(", ");if(t&&!CHI_STATES.includes(t)){throw new Error("".concat(t," is not a valid state for input. If provided, valid values are: ").concat(i,". "))}};t.prototype.validateSelectMode=function(t){if(t===""){this.selectMode="single"}else if(t&&!DROPDOWN_SELECT_MODES.includes(t)){throw new Error("".concat(t," is not a valid select mode for Dropdown. Valid values are ").concat(DROPDOWN_SELECT_MODES.join(", "),"."))}};t.prototype._setSelectModeProps=function(){if(this.selectMode){this.retainSelection=true;this.fluid=true;this.animateChevron=true}if(this._isSelectMulti()){this.preventAutoHide=true;this.preventItemSelected=true;this.retainSelection=false;this._updateMultiItems()}};t.prototype._updateFluidClass=function(){this._fluidClass=this.fluid?FLUID_CLASS:""};t.prototype._updateMultiItems=function(){var t=this;var i,n,s,e;this._currentItems=(n=(i=this.items)===null||i===void 0?void 0:i.map((function(i,n){return Object.assign(Object.assign({},i),{id:i.id||t.id+"-"+n})})))!==null&&n!==void 0?n:[];this._currentDirtyItems=(e=(s=this._currentItems)===null||s===void 0?void 0:s.map((function(t){return Object.assign({},t)})))!==null&&e!==void 0?e:[]};t.prototype.updatePopper=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){this._forceRender=!this._forceRender;return[2]}))}))};t.prototype.handleKeyDown=function(t){var i=["ArrowDown","ArrowUp"];if(!i.includes(t.key)||!this.active||!contains(this.el,t.target)){return}t.preventDefault();this._focusMenuItem(t.key);this.eventKeyDown.emit()};t.prototype._configureDropdownPopper=function(){if(!this._referenceElement){if(this._popper){this._popper.destroy();this._popper=null}return}this._initializePopper();this._popper.update()};t.prototype._triggerElement=function(t){var i;var n=(i=this.iconTooltipMessage)===null||i===void 0?void 0:i.trim();return this.icon&&n?h("chi-tooltip",{wrapper:true,message:n},t):t};t.prototype._initializePopper=function(){this._popper=new Popper(this._referenceElement,this._dropdownMenuElement,{modifiers:{applyStyle:{enabled:true},preventOverflow:{boundariesElement:"window"}},removeOnDestroy:true,placement:this.position||"bottom"})};t.prototype._getDropdownMenuSlots=function(){var t=this._isSelectMulti();var i=this.el.querySelector("[slot=menu-header]");var n=t||this.el.querySelector("[slot=menu-footer]");if(i){this._menuHeader=true}if(n){this._menuFooter=true}};t.prototype.getPadding=function(t){return parseInt(getComputedStyle(this._dropdownMenuElement).getPropertyValue("padding-".concat(t)),10)};t.prototype.getTotalElementHeight=function(t){var i=getComputedStyle(t);var n=["height","margin-top","margin-bottom"];return n.reduce((function(t,n){return t+parseInt(i.getPropertyValue(n),10)}),0)};t.prototype.onMenuItemsChange=function(){this.setMenuHeight();this._addClickEventListeners();this.setActiveClassOnMenuItem()};t.prototype.setMenuHeight=function(){if(this.visibleItems){var t=this._dropdownMenuItemsWrapper?this._dropdownMenuItemsWrapper.children:this._dropdownMenuElement.children;var i=t.length<this.visibleItems?t.length:this.visibleItems;var n=0;for(var s=0;s<i;s++){n+=this.getTotalElementHeight(t[s])}if(this._menuFooter||this._menuHeader){this._dropdownMenuItemsWrapper.style.height="".concat(n,"px")}else{var e=this.getPadding("top")+this.getPadding("bottom");this._dropdownMenuElement.style.height="".concat(n+e,"px")}}};t.prototype.setActiveClassOnMenuItem=function(){var t=this;var i=this._getDropdownMenuItems();i.forEach((function(i){var n=t._value.includes(i.textContent);i.classList.toggle(ACTIVE_CLASS,n)}))};t.prototype.setFixedWidth=function(){if(this.retainSelection&&this._referenceElement&&!this.fluid){var t=this._getButtonElement();t.style.width="".concat(this._referenceElement.offsetWidth,"px");t.classList.add(UTILITY_CLASSES.DISPLAY.FLEX,UTILITY_CLASSES.JUSTIFY.BETWEEN)}};t.prototype.setDisplay=function(t){this._dropdownMenuElement.style.display=t};t.prototype.emitHide=function(){this.eventHide.emit()};t.prototype.emitShow=function(){this.eventShow.emit()};t.prototype._updateValue=function(t){t=t.closest(".".concat(DROPDOWN_CLASSES.MENU_ITEM))||t;var i=t.innerText;if(this.selectMode!=="multi"){this._value=[i];this.eventItemSelected.emit(i);return}var n=this._value.indexOf(i);if(n===-1){this._value=__spreadArray(__spreadArray([],this._value,true),[i],false);this.eventItemSelected.emit(i)}else{this._value=this._value.filter((function(t){return t!==i}));this.eventItemDeselected.emit(i)}this.eventValueChanged.emit(this._value)};t.prototype.hide=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){this.setDisplay("none");this.active=false;this.emitHide();return[2]}))}))};t.prototype.show=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){this.setDisplay("block");this.active=true;if(this._popper){this._popper.update()}this.emitShow();return[2]}))}))};t.prototype.toggle=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){if(this.active){this.hide();return[2]}this.show();return[2]}))}))};t.prototype.resetSelection=function(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(i){t=this._getDropdownMenuItems();this._value=[];t.forEach((function(t){t.classList.remove(ACTIVE_CLASS)}));this.eventSelectionReset.emit();return[2]}))}))};t.prototype._focusMenuItem=function(t){var i=this._getDropdownMenuItems();var n=document.activeElement;var s=i.indexOf(n);var e=t==="ArrowUp"?s-1:s+1;if(!i.includes(n)){var r=t==="ArrowUp"?i.length-1:0;return i[r].focus()}if(e===-1){e=i.length-1}else if(e===i.length){e=0}i[e].focus()};t.prototype._isSelectMulti=function(){var t;return Boolean(this.selectMode==="multi"&&((t=this.items)===null||t===void 0?void 0:t.length))};t.prototype._getDropdownMenuItems=function(){var t=this._dropdownMenuElement.children;if(this._dropdownMenuItemsWrapper){t=this._dropdownMenuItemsWrapper.children}return Array.from(t).filter((function(t){return t.classList.contains(DROPDOWN_CLASSES.MENU_ITEM)}))};t.prototype._getButtonElement=function(){return this._referenceElement.querySelector("button")};t.prototype._addEventListeners=function(){document.body.addEventListener("click",this.handlerClick.bind(this));document.body.addEventListener("keydown",this.handleKeyDown.bind(this));if(this.preventItemSelected)return;this._addClickEventListeners()};t.prototype._removeEventListeners=function(){var t=this;var i=this._getDropdownMenuItems();document.body.removeEventListener("click",this.handlerClick);document.body.removeEventListener("keydown",this.handleKeyDown);if(this.preventItemSelected)return;i.forEach((function(i){i.removeEventListener("click",t.handlerSelectedMenuItem)}))};t.prototype._addClickEventListeners=function(){var t=this;var i=this._getDropdownMenuItems();i===null||i===void 0?void 0:i.forEach((function(i){i.addEventListener("click",t.handlerSelectedMenuItem)}))};t.prototype._getButtonContent=function(){var t=this.button;var i=this._currentItems.filter((function(t){return t.checked})).length;if(this.icon){t=h("chi-icon",{icon:this.icon})}else if(i){t="(".concat(i,") ").concat(t)}else if(this.retainSelection&&this._value.length){t=h("span",{class:UTILITY_CLASSES.TYPOGRAPHY.TEXT_TRUNCATE},this._value.join(" ; "))}return t};t.prototype._getHelperMessage=function(){return this.helperMessage&&h("chi-helper-message",{state:this.state},this.helperMessage)};t.prototype.renderTrigger=function(){var t=this;var i,n,s;var e=this._getButtonContent();var r=(i=this.color)!==null&&i!==void 0?i:"";var o=(n=this.variant)!==null&&n!==void 0?n:"";var a=(s=this.size)!==null&&s!==void 0?s:"";var u=this.icon?"icon":"";var c=this.button||this.icon;var f=this._customTrigger?h("slot",{name:"trigger"}):null;var l=h("chi-button",{onChiClick:this.handlerClickTrigger,onChiMouseEnter:this.handlerMouseEnter,fluid:this.fluid||!!this.helperMessage,"extra-class":this.getExtraClassForTriggerButton(),alternativeText:this.icon,color:r,variant:o,size:a,uppercase:this.uppercase,disabled:this.disabled,type:u,ref:function(i){return t._referenceElement=i}},e);return c?this._triggerElement(l):f};t.prototype.getExtraClassForTriggerButton=function(){return[DROPDOWN_CLASSES.TRIGGER,this.fontWeight&&"-text--".concat(this.fontWeight),this.active&&ACTIVE_CLASS,this.animateChevron&&ANIMATE_CLASS,this.icon&&DROPDOWN_CLASSES.ICON,this.selectMode&&DROPDOWN_CLASSES.SELECT_MODE,this.state&&"-b--".concat(this.state)].filter(Boolean).join(" ")};t.prototype.renderDropdownMenuHeader=function(){var t=h("slot",{name:"menu-header"});return this._menuHeader&&h("div",{class:"".concat(DROPDOWN_CLASSES.MENU_HEADER," ").concat(UTILITY_CLASSES.MARGIN.BOTTOM[1])},t)};t.prototype.renderDropdownMenuFooter=function(t){var i=t?this.renderSelectMultiFooterContent():h("slot",{name:"menu-footer"});return this._menuFooter&&h("div",{class:"".concat(DROPDOWN_CLASSES.MENU_FOOTER," ").concat(UTILITY_CLASSES.MARGIN.TOP[1])},i)};t.prototype.renderDropdownMenuItems=function(t){var i=this;var n=t?this.renderSelectMultiItems():h("slot",{name:"menu"});return this.visibleItems&&(this._menuFooter||this._menuHeader)?h("div",{class:DROPDOWN_CLASSES.MENU_ITEMS_WRAPPER,ref:function(t){return i._dropdownMenuItemsWrapper=t}},n):n};t.prototype.renderMenu=function(){var t=this;var i=this._isSelectMulti();return h("div",{class:"\n          ".concat(DROPDOWN_CLASSES.MENU,"\n          ").concat(UTILITY_CLASSES.Z_INDEX.Z_10,"\n          ").concat(this.active?ACTIVE_CLASS:"","\n          ").concat(this._fluidClass,"\n          ").concat(this.description?LIST_CLASS:""),ref:function(i){return t._dropdownMenuElement=i}},this.renderDropdownMenuHeader(),this.renderDropdownMenuItems(i),this.renderDropdownMenuFooter(i))};t.prototype.renderSelectMultiFooterContent=function(){var t=this;var i=[UTILITY_CLASSES.DISPLAY.FLEX,UTILITY_CLASSES.JUSTIFY.END,UTILITY_CLASSES.PADDING[1],UTILITY_CLASSES.PADDING.RIGHT[2]].join(" ");return[h("div",{class:DIVIDER_CLASSES.DIVIDER}),h("div",{class:i},h("chi-button",{size:"xs",class:UTILITY_CLASSES.MARGIN.RIGHT[1],onClick:function(){return t.onSelectMultiClear()}},"Clear"),h("chi-button",{size:"xs",color:"primary",onClick:function(){return t.onSelectMultiApply()}},"Apply"))]};t.prototype.renderSelectMultiItems=function(){var t=this;return this._currentDirtyItems.map((function(i){return h("chi-checkbox",{label:i.label,class:DROPDOWN_CLASSES.MENU_ITEM,checked:i.checked||null,name:"".concat(t.id,"-group"),id:i.id,onChiChange:function(n){return t._selectMultiItemClicked(n,i)}})}))};t.prototype.onSelectMultiApply=function(){this.hide();this._currentItems=this._currentDirtyItems;this._currentDirtyItems=this._currentItems.map((function(t){return Object.assign({},t)}));this.onMultiItemsChanged()};t.prototype.onSelectMultiClear=function(){this._clearMultiItemsSelection();this._currentItems=this._currentDirtyItems.map((function(t){return Object.assign({},t)}));this.onMultiItemsChanged()};t.prototype.onMultiItemsChanged=function(){this.eventValueChanged.emit(this._currentItems)};t.prototype._clearMultiItemsSelection=function(){var t=Array.from(this.el.querySelectorAll("chi-checkbox[checked]"));this._currentDirtyItems.forEach((function(t){return t.checked=false}));t.forEach((function(t){return t.removeAttribute("checked")}))};t.prototype._selectMultiItemClicked=function(t,i){t.stopPropagation();i.checked=!i.checked};t.prototype.render=function(){var t=this.renderTrigger();var i=this.renderMenu();return t?h("div",{class:"\n        ".concat(DROPDOWN_CLASSES.DROPDOWN,"\n        ").concat(this.active?ACTIVE_CLASS:"","\n        ").concat(this._fluidClass),onMouseLeave:this.handlerMouseLeave},t,this.helperMessage&&this._getHelperMessage(),i):i};Object.defineProperty(t.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{position:["positionValidation"],active:["updateActive"],state:["stateValidation"],selectMode:["_setSelectModeProps"],fluid:["_updateFluidClass"],items:["_updateMultiItems"]}},enumerable:false,configurable:true});return t}();Dropdown.style=ChiDropdownStyle0;export{Checkbox as chi_checkbox,Dropdown as chi_dropdown};