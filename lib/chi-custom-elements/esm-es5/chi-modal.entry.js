var __awaiter=this&&this.__awaiter||function(t,i,n,e){function s(t){return t instanceof n?t:new n((function(i){i(t)}))}return new(n||(n=Promise))((function(n,r){function h(t){try{o(e.next(t))}catch(t){r(t)}}function a(t){try{o(e["throw"](t))}catch(t){r(t)}}function o(t){t.done?n(t.value):s(t.value).then(h,a)}o((e=e.apply(t,i||[])).next())}))};var __generator=this&&this.__generator||function(t,i){var n={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},e,s,r,h;return h={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(h[Symbol.iterator]=function(){return this}),h;function a(t){return function(i){return o([t,i])}}function o(a){if(e)throw new TypeError("Generator is already executing.");while(h&&(h=0,a[0]&&(n=0)),n)try{if(e=1,s&&(r=a[0]&2?s["return"]:a[0]?s["throw"]||((r=s["return"])&&r.call(s),0):s.next)&&!(r=r.call(s,a[1])).done)return r;if(s=0,r)a=[a[0]&2,r.value];switch(a[0]){case 0:case 1:r=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;s=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(r=n.trys,r=r.length>0&&r[r.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){n.label=a[1];break}if(a[0]===6&&n.label<r[1]){n.label=r[1];r=a;break}if(r&&n.label<r[2]){n.label=r[2];n.ops.push(a);break}if(r[2])n.ops.pop();n.trys.pop();continue}a=i.call(t,n)}catch(t){a=[6,t];s=0}finally{e=r=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};import{r as registerInstance,c as createEvent,h,g as getElement}from"./index-422a57bb.js";import{M as MODAL_CLASSES,N as NO_BORDER_CLASS,b as ACTIVE_CLASS,l as CLOSED_CLASS,U as UTILITY_CLASSES,B as BACKDROP_CLASSES,m as CENTER_CLASS,n as INVERSE_CLASS,o as ANIMATED_CLASS,d as TRANSITIONING_CLASS}from"./classes-26189a5f.js";import{j as joinArrayValues}from"./utils-48628cb4.js";import{T as ThreeStepsAnimation}from"./ThreeStepsAnimation-a718d5b8.js";import{M as MODAL_CONTENT_HEIGHT,g as MODAL_BACKDROP_HEIGHT,A as ANIMATION_DURATION}from"./constants-e61c7d0c.js";import{v as v4}from"./v4-a4ec28c0.js";var TYPOGRAPHY=UTILITY_CLASSES.TYPOGRAPHY;var Modal=function(){function t(t){var i=this;registerInstance(this,t);this.chiModalShow=createEvent(this,"chiModalShow",7);this.chiModalShown=createEvent(this,"chiModalShown",7);this.chiModalHide=createEvent(this,"chiModalHide",7);this.chiModalHidden=createEvent(this,"chiModalHidden",7);this.chiModalAccept=createEvent(this,"chiModalAccept",7);this.chiModalCancel=createEvent(this,"chiModalCancel",7);this.subtitle="";this.active=false;this.button="";this.center=false;this.closable=true;this.inverse=false;this.animated=true;this.noBorder=false;this.simple=false;this.isActive=this.active;this._uuid4=v4();this.getUpdateAnimationClasses=function(t,n){var e=["".concat(TRANSITIONING_CLASS," ").concat(t),TRANSITIONING_CLASS];var s=[TRANSITIONING_CLASS,"".concat(TRANSITIONING_CLASS," ").concat(n)];if(!i.isActive){e.reverse();s.reverse()}return[e,s]};this.getCloseButton=function(){return h("chi-button",{type:"close",class:UTILITY_CLASSES.DISPLAY.FLEX,"data-dismiss":"modal","aria-label":"Close",onClick:function(){return i.cancel()}})};this.cancel=function(){i.hide();i.chiModalCancel.emit()};this.accept=function(){i.hide();i.chiModalAccept.emit()};this.getFooter=function(){return h("footer",{class:"".concat(MODAL_CLASSES.FOOTER," ").concat(i.noBorder?NO_BORDER_CLASS:"")},h("slot",{name:"footer"},h("chi-button",{"data-dismiss":"modal",onClick:function(){return i.cancel()}},"Cancel"),h("chi-button",{color:"primary",onClick:function(){return i.accept()}},"Save")))}}t.prototype.sectionAnimationClassesChanged=function(){this.isActive=this.sectionAnimationClasses.includes(ACTIVE_CLASS)};t.prototype.contentHeightValidation=function(t){this.validateScrollValue(t,"content-height")};t.prototype.backdropHeightValidation=function(t){this.validateScrollValue(t,"backdrop-height")};t.prototype.triggerValidation=function(){var t=[this.button,this.reference,this.el.querySelector('[slot="trigger"]')].filter(Boolean);var i=t.length;if(i===0){throw new Error("No trigger detected. Please provide one trigger. Modal ID is ".concat(this._uuid4,"."))}else if(i>1){throw new Error("Multiple triggers detected. Please provide only one trigger. Modal ID is ".concat(this._uuid4,"."))}};t.prototype.validateScrollValue=function(t,i){if(t!==undefined&&t%8!==0){this.el.removeAttribute(i);throw new Error("".concat(t," is not a valid value for ").concat(i,". Values must be multiples of 8."))}};t.prototype.connectedCallback=function(){if(this.el.hasAttribute("content-height")){this.contentHeight=this.contentHeight||MODAL_CONTENT_HEIGHT}if(this.el.hasAttribute("backdrop-height")){this.backdropHeight=this.backdropHeight||MODAL_BACKDROP_HEIGHT}};t.prototype.componentDidLoad=function(){var t=this;this._referenceElement=this.reference&&document.getElementById(this.reference);var i=this._referenceElement||this.el.querySelector('[slot="trigger"]');if(i){i.addEventListener("click",(function(){return t.toggle()}))}};t.prototype.componentWillLoad=function(){this.triggerValidation();this.contentHeightValidation(this.contentHeight);this.backdropHeightValidation(this.backdropHeight);this.sectionAnimationClasses=this.isActive?ACTIVE_CLASS:"";this.backdropAnimationClasses=this.isActive?"":CLOSED_CLASS};t.prototype.updateAnimationClasses=function(t,i){this.sectionAnimationClasses=t;this.backdropAnimationClasses=i};t.prototype.handleAnimation=function(t,i,n){var e=this;if(this._animation&&!this._animation.isStopped()){this._animation.stop()}if(this.animated){var s=this.getUpdateAnimationClasses(t,i),r=s[0],h=s[1];this._animation=ThreeStepsAnimation.animationFactory((function(){return e.updateAnimationClasses(r[0],r[1])}),(function(){return e.updateAnimationClasses(h[0],h[1])}),n,ANIMATION_DURATION.MEDIUM)}else{n()}};t.prototype.show=function(){return __awaiter(this,void 0,void 0,(function(){var t;var i=this;return __generator(this,(function(n){t=function(){i.updateAnimationClasses(ACTIVE_CLASS,"");i.chiModalShown.emit()};this.chiModalShow.emit();this.handleAnimation(CLOSED_CLASS,ACTIVE_CLASS,t);return[2]}))}))};t.prototype.hide=function(){return __awaiter(this,void 0,void 0,(function(){var t;var i=this;return __generator(this,(function(n){t=function(){i.updateAnimationClasses("",CLOSED_CLASS);i.chiModalHidden.emit()};this.chiModalHide.emit();this.handleAnimation(ACTIVE_CLASS,CLOSED_CLASS,t);return[2]}))}))};t.prototype.toggle=function(){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:if(!this.isActive)return[3,2];return[4,this.hide()];case 1:t=i.sent();return[3,4];case 2:return[4,this.show()];case 3:t=i.sent();i.label=4;case 4:t;return[2]}}))}))};t.prototype.getContent=function(){var t=joinArrayValues([MODAL_CLASSES.CONTENT,this.simple&&"".concat(TYPOGRAPHY.TEXT_CENTER," ").concat(UTILITY_CLASSES.PADDING[6])]);var i=this.contentHeight?{maxHeight:"".concat(this.contentHeight,"px")}:undefined;return h("div",{class:t,style:i},h("slot",null))};t.prototype.getHeader=function(){var t=!this.simple&&Boolean(this.modalTitle||this.subtitle||this.closable);if(!t)return;return h("header",{class:"".concat(MODAL_CLASSES.HEADER," ").concat(this.noBorder?NO_BORDER_CLASS:"")},h("h2",{class:MODAL_CLASSES.TITLE},this.modalTitle),this.subtitle&&h("h3",{class:MODAL_CLASSES.SUBTITLE},this.subtitle),this.closable&&this.getCloseButton())};t.prototype.getTrigger=function(){var t=this;return h("slot",{name:"trigger"},h("chi-button",{id:"modal-trigger-".concat(this._uuid4),class:MODAL_CLASSES.TRIGGER,"data-target":"#".concat(this._uuid4),onClick:function(){return t.toggle()}},this.button))};t.prototype.getBackdropClasses=function(){return joinArrayValues([BACKDROP_CLASSES.BACKDROP,this.backdropAnimationClasses,this.center&&CENTER_CLASS,this.inverse&&INVERSE_CLASS,this.animated&&ANIMATED_CLASS])};t.prototype.getSectionClasses=function(){return joinArrayValues([MODAL_CLASSES.MODAL,this.sectionAnimationClasses,this.animated&&ANIMATED_CLASS])};t.prototype.getModal=function(){var t={id:this._uuid4,class:this.getSectionClasses(),role:"dialog","aria-label":"Modal description","aria-modal":"true"};var i=this.backdropHeight?{maxHeight:"".concat(this.backdropHeight,"px")}:undefined;return h("div",{class:this.getBackdropClasses(),style:i},h("div",{class:BACKDROP_CLASSES.WRAPPER},h("section",Object.assign({},t),this.simple&&this.closable&&this.getCloseButton(),this.getHeader(),this.getContent(),!this.simple&&this.getFooter())))};t.prototype.render=function(){return this.reference?this.getModal():h("div",null,this.getTrigger(),this.getModal())};Object.defineProperty(t.prototype,"el",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{sectionAnimationClasses:["sectionAnimationClassesChanged"],contentHeight:["contentHeightValidation"],backdropHeight:["backdropHeightValidation"]}},enumerable:false,configurable:true});return t}();export{Modal as chi_modal};